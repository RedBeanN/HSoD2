doctype html
html
  head
    title= title
    //- view port
    meta(name="viewport", content="initial-scale=1, maximum-scale=1, width=device-width, viewport-fit=cover")
    //- meta
    meta(name="keywords", content="搞事学园,崩坏学园2,崩坏2,崩坏")
    meta(name="author", content="红豆")
    meta(name="description", content="搞事学园 - 《崩坏学园2》非官方数据站")
    link(rel='shortcut icon', href='/favicon.png', type='image/png')
    //- PWA specific
    link(rel="manifest", href="/manifest.json")
    meta(name='theme-color' content='#3f51b5')
    //- for iOS safari
    link(rel="apple-touch-icon", href="/favicon.jpg")
    meta(name="apple-mobile-web-app-capable" content="yes")
    meta(name="mobile-web-app-capable" content="yes")
    meta(name="apple-mobile-web-app-status-bar-style" content="black-translucent")
    meta(name='apple-mobile-web-app-title' content="搞事学园")
    // Global site tag (gtag.js) - Google Analytics
    style.
      .mdui-appbar, .mdui-drawer {
        background: #3f51b5;
        position: fixed;
        padding-top: constant(safe-area-inset-top) !important;
        padding-top: env(safe-area-inset-top) !important;
      }
      html {
        padding-top: constant(safe-area-inset-top) !important;
        padding-top: env(safe-area-inset-top) !important;
      }
      #loading-hover, #loading-container, #loading-icon {
        transition-duration: .2s;
        transition-timing-function: linear;
      }
      #loading-container {
        transition-timing-function: ease;
      }
      #loading-hover {
        position: fixed;
        width: 100%;
        height: 100%;
        left: 0;
        top: 0;
        z-index: 9999;
        background-color: #3f51b5;
      }
      #loading-container {
        width: 100%;
        height: 56px;
        position: absolute;
        top: 50%;
        margin-top: -64px;
        text-align: center;
        overflow: visible;
      }
      #loading-icon {
        width: 96px;
        height: 96px;
        display: inline-block;
        background-image: url('/favicon.png');
        background-size: 96px 96px;
      }
      #loading-hover.entered #loading-icon {
        background-image: url('/images/favicon-r.png');
      }
      #loading-content {
        color: white;
        font-size: 20px;
        text-align: center;
        transition-duration: .15s;
        margin-top: 16px;
      }
      #loading-hover.entering #loading-content {
        opacity: 0;
      }
      #loading-hover.loaded {
        height: 56px;
        line-height: 56px;
        text-align: right;
      }
      #loading-hover.loaded #loading-container {
        top: 0;
        right: 0;
        margin: 0;
        width: 62px;
      }
      #loading-hover.loaded #loading-icon {
        width: 30px;
        height: 30px;
        margin: 0 16px;
        vertical-align: middle;
        background-size: 30px 30px;
      }
      #loading-hover.fadeout {
        opacity: 0;
      }
      #loading-spinner {
        position: relative;
        display: inline-block;
        width: 28px;
        height: 28px;
        animation: spinner 1568ms linear infinite;
        text-align: left;
      }
      @keyframes spinner {
        to {
          transform: rotate(360deg);
        }
      }
      #spinner-layer {
        position: absolute;
        width: 100%;
        height: 100%;
        border-color: white;
        animation: spinner-layer-fill-unfill-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
      }
      @keyframes spinner-layer-fill-unfill-rotate {
        12.5% { transform: rotate(135deg);  }
        25%   { transform: rotate(270deg);  }
        37.5% { transform: rotate(405deg);  }
        50%   { transform: rotate(540deg);  }
        62.5% { transform: rotate(675deg);  }
        75%   { transform: rotate(810deg);  }
        87.5% { transform: rotate(945deg);  }
        to    { transform: rotate(1080deg); }
      }
      .spinner-circle-clipper {
        position: relative;
        display: inline-block;
        width: 50%;
        height: 100%;
        overflow: hidden;
        border-color: inherit;
      }
      .spinner-circle {
        width: 200%;
        height: 100%;
        border-width: 3px;
        border-style: solid;
        border-color: inherit;
        border-bottom-color: transparent !important;
        border-radius: 50%;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        box-sizing: border-box;
      }
      #spinner-left {
        float:left;
      }
      #spinner-right {
        float: right;
      }
      #spinner-left .spinner-circle {
        left: 0;
        border-right-color: transparent !important;
        transform: rotate(129deg);
        animation: spinner-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
      }
      #spinner-right .spinner-circle {
        left: -100%;
        border-left-color: transparent !important;
        transform: rotate(-129deg);
        animation: spinner-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
      }
      @keyframes spinner-left-spin {
        from { transform: rotate(130deg); }
        50%  { transform: rotate(-5deg);  }
        to   { transform: rotate(130deg); }
      }
      @keyframes spinner-right-spin {
        from { transform: rotate(-130deg); }
        50%  { transform: rotate(5deg);    }
        to   { transform: rotate(-130deg); }
      }
      @media (min-width: 600px) {
        #loading-hover.loaded {
          height: 64px;
          line-height: 64px;
        }
      }
    script.
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-123581848-1');
      window.addEventListener('load', () => {
        const loading = document.querySelector('#loading-hover');
        setTimeout(() => {
          loading.classList += 'entering';
        }, 000);
        //- loading.classList += 'enter';
        setTimeout(() => {
          loading.classList += ' entered';
        }, 200);
        setTimeout(() => {
          loading.classList += ' loaded';
        }, 400);
        setTimeout(() => {
          loading.classList += ' fadeout';
        }, 600);
        setTimeout(() => {
          document.body.removeChild(loading);
        }, 800);
      });

  body.mdui-drawer-body-left.mdui-appbar-with-tab-larger.mdui-theme-primary-indigo.mdui-theme-accent-pink
    #loading-hover
      #loading-container
        #loading-icon
        #loading-content
          #loading-spinner
            #spinner-layer
              .spinner-circle-clipper#spinner-left
                .spinner-circle
              .spinner-circle-clipper#spinner-right
                .spinner-circle
    script(src="/javascripts/browser.js")
    block content
    script(type='text/javascript').
      //- if (!window.Reflect) alert('您的浏览器版本过旧，可能无法正常访问搞事学园！');
      if ('serviceWorker' in navigator) navigator.serviceWorker.register('/sw.js');
    script(async src="/gtag.min.js")
