'use strict';function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step('next',value)},function(err){step('throw',err)})}}return step('next')})}}(function(){var $$=mdui.JQ;$$('body').removeClass('mdui-appbar-with-tab-larger');$$('body').addClass('mdui-appbar-with-tab');var app=new Vue({el:'#app',data:{card:{title:'\u6B63\u5728\u4F7F\u7528 PWA \u7248\u641E\u4E8B\u5B66\u56ED',hint:'\u641E\u4E8B\u5B66\u56ED\u91C7\u7528\u7F13\u5B58+\u540E\u53F0\u66F4\u65B0\u7684\u65B9\u5F0F\uFF0C\u9875\u9762\u6709\u66F4\u65B0\u65F6\u5148\u6E32\u67D3\u7F13\u5B58\u7684\u9875\u9762\uFF0C\u518D\u540E\u53F0\u66F4\u65B0\uFF0C\u5728\u4E0B\u4E00\u6B21\u8BBF\u95EE\u540C\u4E00\u9875\u9762\u65F6\u624D\u4F7F\u7528\u66F4\u65B0\u7248\uFF0C\u4EE5\u8FBE\u6210\u5373\u65F6\u8BBF\u95EE\u3001\u65E0\u75D5\u66F4\u65B0\u7684\u6548\u679C\uFF0C\u5982\u679C\u53D1\u73B0\u8BBF\u95EE\u7684\u9875\u9762\u7248\u672C\u8F83\u65E7\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0\u9875\u9762',content:''},balor:{crate:150,cadds:180,minus:42,minmi:150,wz:'1',lowRate:0,lowProb:0,highRate:0,highProb:0,exp:0},drawer:[{url:'/list',name:'UP \u8BB0\u5F55',icon:'date_range'},{url:'/equip',name:'\u88C5\u5907\u6A21\u62DF\u5668',icon:'pages'},{url:'/cms',name:'\u516C\u544A\u8BB0\u5F55',icon:'format_list_bulleted'},{url:'/buglist',name:'\u6D4B\u8BD5\u670D BUG \u8BB0\u5F55',icon:'bug_report'},{url:'/gacha',name:'\u626D\u86CB\u6A21\u62DF\u5668',icon:'casino'},{url:'/illustrate/v3',name:'\u88C5\u5907\u56FE\u9274',icon:'art_track'},{url:'/innerWorld',name:'\u91CC\u5854\u52A9\u624B',icon:'book'},{url:'/talent',name:'\u5723\u75D5\u4E00\u89C8',icon:'all_out'},{url:'/calendar',name:'\u5D29\u574F\u8BFE\u7A0B\u8868',icon:'event_note'}],drawerInst:null,swSize:{total:0,font:0,image:0,script:0,other:0}},computed:{balorRate:function balorRate(){var crate=this.balor.crate/100,cadds=this.balor.cadds/100,minus=this.balor.minus/100,minmi=this.balor.minmi/100;var max=function max(a,b){return a>b?a:b};var baseCri=(2+cadds)*(this.balor.wz?2:1);var cris=[baseCri];var i=1;while(true){if(crate>i){var _cri=max(minmi,baseCri*(1-minus*i));cris.push(_cri);i++}else break}var highProb=toFloat(crate-i+1);var lowProb=toFloat(1-highProb);this.balor.highProb=toFloat(highProb*100);this.balor.lowProb=toFloat(lowProb*100);this.balor.highRate=toFloat(cris.reduce(function(){var pre=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var cur=arguments[1];return pre*cur}));this.balor.lowRate=toFloat(this.balor.highRate/cris[cris.length-1]);this.balor.exp=toFloat((lowProb*this.balor.lowRate+highProb*this.balor.highRate)*100);return this.balor.highRate+' \u500D'}},methods:{updateSW:function updateSW(){var self=this;if(caches&&caches.keys){caches.keys().then(function(cachenames){var names=cachenames.map(function(i){return i.split('-')[1]});if(!names.length)return;self.card.content='\u5F53\u524D\u4F7F\u7528\u7684\u6570\u636E\u7248\u672C: '+names.join(', ');self.calcSW(cachenames)})}},calcSW:function calcSW(names){var _this=this;return _asyncToGenerator(regeneratorRuntime.mark(function _callee(){var swSize,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,name,cache,keys,_iteratorNormalCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,key,res,ab;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:swSize={total:0,font:0,image:0,script:0,other:0};_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=4;_iterator=names[Symbol.iterator]();case 6:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=49;break}name=_step.value;_context.next=10;return caches.open(name);case 10:cache=_context.sent;_context.next=13;return cache.keys();case 13:keys=_context.sent;_iteratorNormalCompletion2=true;_didIteratorError2=false;_iteratorError2=undefined;_context.prev=17;_iterator2=keys[Symbol.iterator]();case 19:if(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done){_context.next=32;break}key=_step2.value;_context.next=23;return cache.match(key);case 23:res=_context.sent;_context.next=26;return res.arrayBuffer();case 26:ab=_context.sent;swSize.total+=ab.byteLength;addSize(swSize,ab.byteLength,key.url);case 29:_iteratorNormalCompletion2=true;_context.next=19;break;case 32:_context.next=38;break;case 34:_context.prev=34;_context.t0=_context['catch'](17);_didIteratorError2=true;_iteratorError2=_context.t0;case 38:_context.prev=38;_context.prev=39;if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}case 41:_context.prev=41;if(!_didIteratorError2){_context.next=44;break}throw _iteratorError2;case 44:return _context.finish(41);case 45:return _context.finish(38);case 46:_iteratorNormalCompletion=true;_context.next=6;break;case 49:_context.next=55;break;case 51:_context.prev=51;_context.t1=_context['catch'](4);_didIteratorError=true;_iteratorError=_context.t1;case 55:_context.prev=55;_context.prev=56;if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}case 58:_context.prev=58;if(!_didIteratorError){_context.next=61;break}throw _iteratorError;case 61:return _context.finish(58);case 62:return _context.finish(55);case 63:_this.swSize=swSize;case 64:case'end':return _context.stop();}}},_callee,_this,[[4,51,55,63],[17,34,38,46],[39,,41,45],[56,,58,62]])}))()}},filters:{byte2mb:function byte2mb(byte){if(typeof byte!=='number'){byte=Number(byte);if(isNaN(byte))return}return toFloat(byte/1024/1024)}},created:function created(){var _this2=this;this.updateSW();setInterval(function(){_this2.updateSW()},5000)},mounted:function mounted(){mdui.mutation();$$('.hide').removeClass('hide')},updated:function updated(){mdui.mutation();$$('.hide').removeClass('hide')}});function addSize(s,l,url){if(typeof url!=='string')return;if(url.indexOf('font')!==-1)return s.font+=l;if(url.indexOf('image')!==-1)return s.image+=l;if(url.indexOf('js')!==-1)return s.script+=l;return s.other+=l}function toFloat(f){if(typeof f!=='number'){try{f=Number(f);if(isNaN(f))return 0}catch(_){return 0}}return parseFloat(f.toFixed(4))}})();