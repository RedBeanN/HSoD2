(function(t){function e(e){for(var n,r,i=e[0],c=e[1],l=e[2],d=0,m=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(m.length)m.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,i=1;i<a.length;i++){var c=a[i];0!==o[c]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},o={app:0},s=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/m/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("85ec"),o=a.n(n);o.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("header",{staticClass:"mdui-appbar mdui-appbar-fixed",attrs:{id:"mirai-header"}},[a("div",{staticClass:"mdui-toolbar mdui-color-theme"},[t._m(0),a("a",{staticClass:"mdui-typo-headline"},[t._v(t._s(t.appTitle))]),a("div",{staticClass:"mdui-toolbar-spacer"}),a("img",{staticClass:"mdui-icon",attrs:{id:"header-icon",src:"https://redbean.tech/images/favicon-r.png"}})])]),a("div",{staticClass:"mdui-container"},[a("keep-alive",[a("transition",{attrs:{name:"fade",mode:"out-in"}},[t.atStartPage?a("CommunityStart",{staticClass:"mdui-col-xs-12 mdui-col-sm-6",on:{toggleStart:function(e){t.atStartPage=!t.atStartPage},getToken:t.getToken}}):t._e(),t.atStartPage?t._e():a("CommunityToken",{staticClass:"mdui-col-xs-12 mdui-col-sm-6",attrs:{logs:t.logs,members:t.members},on:{toggleStart:function(e){t.atStartPage=!t.atStartPage}}})],1)],1),a("div",{staticClass:"mdui-container mdui-m-t-2 mdui-col-xs-12 mdui-col-sm-6"},[a("div",{staticClass:"mdui-theme-layout-dark",attrs:{id:"logs"}},t._l(t.logs,(function(e){return a("div",{staticClass:"log",domProps:{innerHTML:t._s(t.formatLog(e))}})})),0)])],1)])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white",attrs:{href:"/"}},[a("i",{staticClass:"mdui-icon material-icons"},[t._v("home")])])}],r=(a("99af"),a("a15b"),a("d81d"),a("b0c0"),a("53ca")),i=a("2a31"),c=a.n(i),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"community-start"}},[a("div",{staticClass:"mdui-container mdui-m-t-2"},[a("div",{staticClass:"mdui-typo"},[a("h1",[t._v("开始使用")]),t._m(0),a("p",[t._v("使用步骤")]),a("ul",[a("li",[t._v("选择服务器 "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.server,expression:"server"}],staticClass:"mdui-select mdui-m-l-1",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.server=e.target.multiple?a:a[0]}}},t._l(t.serverlist,(function(e){return a("option",{domProps:{value:e.val}},[t._v(t._s(e.name))])})),0)]),a("li",[t._v("从本页面获取验证码和大厅")]),a("li",[t._v("使用团长或代团账号前往游戏内指定大厅发送“验证码xxxxxx”")]),a("li",[t._v("服务器返回token，使用该token可以获取所在社团的数据(token可以重复使用，每周限获取10次)")])])]),a("a",{staticClass:"mdui-btn mdui-ripple mdui-shadow-1",on:{click:t.getToken}},[t._v("获取验证码和大厅")]),a("a",{staticClass:"mdui-btn mdui-ripple mdui-shadow-1",on:{click:t.toggle}},[t._v("前往使用token >")])])])},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("使用社团助手，可以获取社团的团员数据，如团本团战贡献等，"),a("b",[t._v("强烈建议使用电脑，手机端可能存在兼容性问题")])])}],d={name:"CommunityStart",data:function(){return{server:"orig",serverlist:[{name:"国服",val:"orig"},{name:"测试服",val:"beta"},{name:"B1",val:"b1"},{name:"B2",val:"b2"},{name:"UC1/九游",val:"uc1"},{name:"UC2",val:"uc1"},{name:"360S1",val:"360s1"},{name:"360S2",val:"360s2"},{name:"混服",val:"mix"},{name:"腾讯服",val:"tencent"}]}},methods:{toggle:function(){this.$emit("toggleStart")},getToken:function(){this.$emit("getToken",this.server)}}},m=d,p=a("2877"),f=Object(p["a"])(m,l,u,!1,null,null,null),h=f.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.atStartPage?t._e():a("div",{staticClass:"mdui-container mdui-m-t-2",on:{toggleStart:function(e){t.atStartPage=!t.atStartPage}}},[a("div",{staticClass:"mdui-typo"},[a("h1",[t._v("使用token获取社团数据")]),a("p",[t._v("请在下方输入已注册的token，token可以重复使用")]),t._m(0),a("div",{staticClass:"mdui-textfield mdui-textfield-floating-label"},[a("label",{staticClass:"mdui-textfield-label"},[t._v("token")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.token,expression:"token"}],staticClass:"mdui-textfield-input",domProps:{value:t.token},on:{input:function(e){e.target.composing||(t.token=e.target.value)}}})])]),a("a",{staticClass:"mdui-btn mdui-ripple mdui-shadow-1",on:{click:t.toggle}},[t._v("< 返回开始页")]),a("a",{staticClass:"mdui-btn mdui-ripple mdui-shadow-1",on:{click:t.getCommunityData}},[t._v("获取数据")]),a("a",{staticClass:"mdui-btn mdui-ripple mdui-shadow-1",on:{click:t.destroyToken}},[t._v("销毁token")]),t.isReady?a("a",{staticClass:"mdui-btn mdui-ripple mdui-shadow-1",on:{click:t.downloadXls}},[t._v("下载xls")]):t._e()])},g=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("强烈建议使用电脑，手机端可能存在兼容性问题")])])}],b=(a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("5319"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("ddb0"),a("2b3d"),a("2909")),k=a("bc3a"),y=a.n(k),_={data:function(){return{token:"",isReady:!1}},props:["atStartPage","logs","members"],methods:{toggle:function(){this.$emit("toggleStart")},formatMember:function(t){var e="成员";switch(t.type){case 1:e="团长";break;case 2:e="元老";break;case 3:e="团员";break;case 4:e="代团";break}return"".concat(e," - ").concat(t.name)},getCommunityData:function(){var t=this;if(""!==this.token){var e="https://flrscn.redbean.tech/molemole/communitydata/getdata?token=".concat(encodeURIComponent(this.token),"&withsheet=true");y.a.post(e).then((function(e){var a,n=e.data,o=(new Date).toLocaleTimeString("zh",{hour12:!1});if(0===n.code)t.isReady=!0,t.logs.push("[ ".concat(o," ] 获取成功，请点击【下载XLS】保存，当前剩余可用次数").concat(n.times,"。")),t.community=n.data,(a=t.members).push.apply(a,Object(b["a"])(n.data.memberList)),t.xls=n.xls;else switch(n.code){case-1:t.logs.push("[ ".concat(o," ] ErrorCode: -1 服务器内部错误"));break;case 1:t.logs.push("[ ".concat(o," ] ErrorCode: 1 无效的token"));break;case 2:t.logs.push("[ ".concat(o," ] ErrorCode: 2 本周次数用尽"));break;case 3:t.logs.push("[ ".concat(o," ] ErrorCode: 3 冷却中, 剩余")+n.sec+"秒");break;case 4:t.logs.push("[ ".concat(o," ] ErrorCode: 4 服务器未连接"));break;case 5:t.logs.push("[ ".concat(o," ] ErrorCode: 5 申请者已不是团长或代团，token被吊销"));break}}))}},destroyToken:function(){var t=this;if(""!==this.token){var e="https://flrscn.redbean.tech/molemole/communitydata/destroy?token=".concat(encodeURIComponent(this.token));y.a.post(e).then((function(e){var a=e.data,n=(new Date).toLocaleTimeString("zh",{hour12:!1});0===a.code?t.logs.push("[ ".concat(n," ] 销毁成功")):1===a.code?t.logs.push("[ ".concat(n," ] token无效")):-1===a.code&&t.logs.push("[ ".concat(n," ] 服务器内部错误：").concat(a.msg))}))}},dataUrlToFile:function(t,e){var a=t.split(","),n=a[0].match(/:(.*?);/)[1],o=atob(a[1]),s=o.length,r=new Uint8Array(s);while(s--)r[s]=o.charCodeAt(s);var i=new Blob([r],{type:n});return i.lastModifiedDate=new Date,i.name=e.replace(/\s/,"_"),i},downloadXls:function(){var t=this.dataUrlToFile("data:application/vnd.ms-excel;base64,"+this.xls,"".concat(this.community.name," ").concat((new Date).toLocaleString("zh",{hour12:!1}),".xls")),e=document.createElement("a");e.download=t.name.replace(/\s/,"_"),e.href=URL.createObjectURL(t),document.body.appendChild(e),e.click(),document.body.removeChild(e)}}},C=_,w=Object(p["a"])(C,v,g,!1,null,null,null),x=w.exports,S={name:"App",data:function(){return{appTitle:"社团助手",logs:[],members:[],community:{},xls:"",atStartPage:!0,wss:null}},methods:{getToken:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"orig";this.wss&&this.wss.close();var a=new WebSocket("wss://flrscn.redbean.tech/molemole/communitydata/auth?server=".concat(e));a.addEventListener("message",(function(e){var a=e.data;a=JSON.parse(a);var n=(new Date).toLocaleTimeString("zh",{hour12:!1});switch(a.event){case"start":t.logs.push("[ ".concat(n," ] 当前配置：")," > 玩家等级限制：".concat(a.minMemberLevel,"+")," > 允许注册token的社团职位：".concat(a.allowedMemberTypes.map((function(t){return["","团长","元老","成员","代团"][t]})).join("、")," (获取数据没有身份限制)")," > 社团等级限制：".concat(a.minCommunityLevel,"+")," > 社团人数限制：".concat(a.minMemberCount,"+")),t.logs.push({style:"color: #6cf; font-weight: bold; margin-left: 8px; font-size: 20px",text:"验证码".concat(a.code)}),t.logs.push("请前往指定大厅输入“验证码".concat(a.code,"”(不含引号)，大厅会定时刷新，以最新大厅号为准"));break;case"chatroom":t.logs.push("[ ".concat(n," ] 大厅：").concat(a.room));break;case"success":t.logs.push("[ ".concat(n," ] 你的社团为【").concat(a.name,"】")),t.logs.push("[ ".concat(n," ] token：")),t.logs.push({style:"color: #6cf; font-weight: bold; margin-left: 8px; font-size: 20px",text:a.token}),t.logs.push("token可以多次使用，请小心保管token");break;case"timeout":t.logs.push("[ ".concat(n," ] 连接超时，请稍后重试"));break;case"error":case"failed":t.logs.push("[ ".concat(n," ] 错误：").concat(a.msg));break}})),this.wss=a},formatLog:function(t){return"object"===Object(r["a"])(t)?"text"in t?t.style?'<p style="'.concat(t.style,'">').concat(t.text,"</p>"):t.text:"":t}},watch:{logs:function(){var t=document.getElementById("logs");t.scrollTop=t.scrollHeight}},components:{CommunityStart:h,CommunityToken:x},created:function(){c.a.JQ("body").removeClass("mdui-drawer-body-left"),c.a.mutation()}},T=S,P=(a("034f"),Object(p["a"])(T,o,s,!1,null,null,null)),O=P.exports;a("725e");n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(O)}}).$mount("#app")},"85ec":function(t,e,a){}});