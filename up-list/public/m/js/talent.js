"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}(function(){var $$=mdui.JQ;$$("body").removeClass("mdui-drawer-body-left");Vue.component("talent-detail",{render:function render(h){var _this=this;if(!this.detail)return;if(this.detail.includes("#TD")){var splited=this.detail.split(/#TD\d+/);var matched=this.detail.match(/#TD(\d+)/g);if(!matched)return h(p,this.detail);var child=[];for(var i=0;i<splited.length;i++){child.push(h("span",splited[i]));if(matched[i]){(function(){var id=matched[i].replace("#TD","");child.push(h("span",{on:{click:function click(){_this.$emit("click",id)}},"class":{link:true}},[_this.talentmap?_this.talentmap[id]||id:id]))})()}}return h("p",{"class":"talent-detail-text"},child)}else{return h("p",{"class":"talent-detail-text"},this.detail)}},props:{detail:String,talentmap:Object}});var characterMap={"4001":"\u742A\u4E9A\u5A1C\xB7\u5361\u65AF\u5170\u5A1C","4002":"\u96F7\u7535\u82BD\u8863","4003":"\u5E03\u6D1B\u59AE\u5A05\xB7\u624E\u4F0A\u5207\u514B","4004":"\u65E0\u91CF\u5854\u59EC\u5B50","4005":"\u5FB7\u8389\u838E\xB7\u963F\u6CE2\u5361\u5229\u65AF","4006":"\u5E0C\u513F\xB7\u8299\u4E50\u827E","4007":"\u674F\xB7\u739B\u5C14","4008":"\u84EC\u83B1\u5BFA\u4E5D\u9704","4009":"\u4F0A\u745F\u7433\xB7\u5229\u7EF4\u4F11\u65AF","4010":"\u7B26\u534E","4011":"\u65E0\u8272\u8F89\u706B","4012":"\u897F\u7433","4013":"\u4E3D\u5854","4014":"\u5B81\u8482","4015":"\u8FE6\u5A1C","4016":"\u8299\u5170","4017":"\u83F2\u7C73\u8389\u4E1D","4018":"\u8BD7\u97F3"};var characterMapShort={"4001":"\u742A\u4E9A\u5A1C","4002":"\u82BD\u8863","4003":"\u5E03\u6D1B\u59AE\u5A05","4004":"\u59EC\u5B50","4005":"\u5FB7\u8389\u838E","4006":"\u5E0C\u513F","4007":"\u674F","4008":"\u4E5D\u9704","4009":"\u4F0A\u745F\u7433","4010":"\u7B26\u534E","4011":"\u8F89\u706B","4012":"\u897F\u7433","4013":"\u4E3D\u5854","4014":"\u5B81\u8482","4015":"\u8FE6\u5A1C","4016":"\u8299\u5170","4017":"\u83F2\u7C73\u8389\u4E1D","4018":"\u8BD7\u97F3"};new Vue({el:"#app",data:{allTalents:{},characters:[],character:"",characterMap:characterMap,characterMapShort:characterMapShort,extra:[],title:"",detail:"",level:"",sprites:{},showExtra:false,linkDetail:null,detailDialog:null},computed:{currentTalent:function currentTalent(){return this.allTalents[this.character]||[]},talents:function talents(){return this.currentTalent.filter(function(i){return i.uid<999})},extraTalents:function extraTalents(){return this.currentTalent.filter(function(i){return i.uid>999})},hasExtra:function hasExtra(){return this.currentTalent.filter(function(i){return i.uid>999}).length>0},sprite:function sprite(){var s={};for(var k in this.sprites){var i=this.sprites[k];s[k]={backgroundPosition:"".concat(-32*(i[0]-1),"px ").concat(-32*(i[1]-1),"px")}}return s},talentMap:function talentMap(){var obj={};this.currentTalent.forEach(function(i){obj[i.uid]=i.title});return obj}},methods:{setCharacter:function setCharacter(_char){if(this.characters.includes(_char))this.character=_char;this.title="";this.detail=""},position:function position(x,y){return{left:500*x-50+"px",top:630*(1-y)-110+"px"}},extraPosition:function extraPosition(id){var x=0,y=0;loop:for(var i=0;i<this.extra.length;i++){for(var j=0;j<this.extra[i].length;j++){if(parseInt(this.extra[i][j])==parseInt(id)){x=i,y=j;break loop}}}return{left:(y+1)*0.2*400+"px",top:(x%3+1)*0.2*240-40+"px"}},showDetail:function showDetail(talent){var title=talent.title,maxLvDesc=talent.maxLvDesc,alb=talent.alb,maxLevel=talent.maxLevel;this.title=title;this.level=maxLevel;var reg=new RegExp("[d{2}.]{".concat(parseInt(alb/2),"}"),"g");this.detail=maxLvDesc.replace(reg,"$&\n")},showTalent:function showTalent(id){var _this2=this;var _iterator=_createForOfIteratorHelper(this.currentTalent),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;if(item.uid===id){this.linkDetail=item;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(this.linkDetail){this.$nextTick(function(){if(!_this2.detailDialog){_this2.detailDialog=new mdui.Dialog("#detail-dialog",{history:false,closeOnEsc:function closeOnEsc(){}});_this2.detailDialog.open()}else{_this2.$nextTick(function(){_this2.detailDialog.handleUpdate();_this2.detailDialog.open()})}})}},loadAllData:function loadAllData(){var _this3=this;this.showLoading();axios.get("/talent/data").then(function(res){if(res.data){_this3.$set(_this3,"allTalents",res.data.talents);_this3.$set(_this3,"extra",res.data.extra);_this3.characters=[];for(var key in res.data.talents){_this3.characters.push(key)}_this3.character=_this3.characters[0]}_this3.hideLoading()});axios.get("/talent/sprite").then(function(res){if(res.data)_this3.$set(_this3,"sprites",res.data)})},showLoading:function showLoading(){$$("#progress").css("opacity","1")},hideLoading:function hideLoading(){$$("#progress").css("opacity","0")}},created:function created(){this.loadAllData()},mounted:function mounted(){$$(".hide").removeClass("hide")}})})();