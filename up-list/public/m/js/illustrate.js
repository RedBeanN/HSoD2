'use strict';function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}(function(){if(confirm('\u7531\u4E8E\u5B98\u65B9\u6570\u636E\u6E90\u5185\u5BB9\u4E0D\u5B8C\u6574\uFF0C\u6B64\u9875\u9762\u5DF2\u505C\u6B62\u66F4\u65B0\uFF0C\u662F\u5426\u8F6C\u81F3\u91C7\u7528\u65B0\u6570\u636E\u6E90\u7684\u9875\u9762\uFF1F'))window.location.href='/illustrate/v2';var $$=mdui.JQ;$$('#back-to-index').remove();$$('body').removeClass('mdui-drawer-body-left');$$('.hide').removeClass('hide');var equipTemplate={'id':'?','type':'?','max_lv':'35','cost':'6','display_image':'3','display_title':'?','rarity':'0','empty_star':'0','display_ammo':'?','display_firerate':'10','display_damage':'150','display_base_type':'?','display_prop1_title':'\u627E\u4E0D\u5230\u56FE\u9274','display_prop1_desc':'\u65E0\u6CD5\u83B7\u5F97\u8FD9\u4E2A\u88C5\u5907\u7684\u8BE6\u7EC6\u4FE1\u606F , \u53EF\u80FD\u662F miHoYo \u7684\u6570\u636E\u63A5\u53E3\u5C1A\u672A\u5F00\u653E , \u6216\u8005\u662F\u5355\u7EAF\u7684\u7F51\u7EDC\u95EE\u9898.'};var app=new Vue({el:'#app',data:{equips:{weapon:[],costume:[],passive_skill:[],pet:[]},equip:equipTemplate,current:{type:'all',page:1,itemPerPage:20},searchInput:'',tabs:{'weapon':'\u6B66\u5668','costume':'\u8863\u670D','passive_skill':'\u5FBD\u7AE0','pet':'\u4F7F\u9B54'}},computed:{items_:function items_(){var arr=[];if(this.current.type!=='all')arr.push.apply(arr,_toConsumableArray(this.equips[this.current.type]));else for(var type in this.equips){arr.push.apply(arr,_toConsumableArray(this.equips[type]))}return this.parseEquips(arr)},totalPages:function totalPages(){var ipp=this.current.itemPerPage;if(ipp<1)ipp=1;return Math.ceil(this.items.length/ipp)},pages:function pages(){var pagenum=this.totalPages;if(pagenum<6){var arr=[];for(var i=1;i<=pagenum;i++){arr.push(i)}return arr}if(this.current.page<1)this.current.page=1;if(this.current.page>pagenum)this.current.page=pagenum;var p=this.current.page;if(p<3)return[1,2,3,'...',pagenum];if(p>pagenum-2)return[1,'...',pagenum-2,pagenum-1,pagenum];else return['...',p-1,p,p+1,'...']},itemsInPage:function itemsInPage(){var page=this.current.page;var ipp=this.current.itemPerPage;if(!page)page=1;if(!ipp)ipp=1;var start=(page-1)*ipp;var items=[];for(var i=start;i<start+ipp;i++){if(this.items[i])items.push(this.items[i])}this.backToTop();return items},items:function items(){if(this.searchInput==='')return this.items_;var arr=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.items_[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var i=_step.value;if(i.name&&i.name.indexOf(this.searchInput)!==-1)arr.push(i)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return arr}},watch:{'current.itemPerPage':function currentItemPerPage(val,oldVal){if(!val)val=1;if(!oldVal)oldVal=1;console.log(val,oldVal);if(val!==oldVal){var page=this.current.page;var itemnum=(page-1)*oldVal+1;this.current.page=Math.ceil(itemnum/val)}},'current.totalPage':function currentTotalPage(val){if(this.current.page>val)this.current.page=val}},methods:{parseEquips:function parseEquips(equips){var arr=[];equips.forEach(function(equip){var data=equip.split('$');arr.push({id:intToString(data[0],3),stars:parseInt(data[1]),name:data[2]})});return arr},paging:function paging(opt){var num=parseInt(opt);var page=1;if(!isNaN(num))page=num;else switch(opt){case'first':page=1;break;case'last':page=this.totalPages;break;case'pre':page=this.current.page-1;break;case'next':page=this.current.page+1;break;}if(page<1||page>this.totalPages)return;else return this.current.page=page},selectTab:function selectTab(tab,e){if(e){$$('.mdui-tab-active').removeClass('mdui-tab-active');$$(e.target).addClass('mdui-tab-active')}this.current.type=tab;this.backToTop();this.paging(1)},loadData:function loadData(){var _this=this;showLoading();axios.get('illustrate/data/minify').then(function(res){_this.equips=res.data;hideLoading()}).catch(function(e){console.error(e)})},showDetail:function showDetail(id,name){var _this2=this;showLoading();axios.get('illustrate/details/'+parseInt(id)).then(function(res){_this2.equip=res.data;_this2.equip.id=id}).catch(function(){_this2.equip=equipTemplate;_this2.equip.id=id;_this2.equip.display_title=name}).then(function(){var dialog=new mdui.Dialog($$('#dialog'),{history:false});Vue.nextTick(function(){dialog.open();hideLoading()})})},backToTop:function backToTop(){document.body.scrollTop=0;document.documentElement.scrollTop=0}},created:function created(){this.loadData()},mounted:function mounted(){mdui.mutation()},filters:{petSkillType:function petSkillType(s){return s.replace(/(使魔)|(技能)/g,'').replace('.','\xB7')}}});function intToString(n,k){var str=n.toString();var result='';for(var i=0;i<k-str.length;i++){result+='0'}return result+str}function showLoading(){$$('#progress').css('opacity',1)}function hideLoading(){$$('#progress').css('opacity',0)}})();